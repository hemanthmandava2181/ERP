<script src="/erp/files/assets/js/erp-scripts/HRMS/employeeemployeeselfserviece/attendanceandTimesheet.js"></script>


<div id="TimeandattendanceDiv"
	data-ng-controller="attendanceandTimeSheet">
	<!-- BreadCrumb Start -->
	<div class="row">
		<div class="col-sm-12">
			<div class="card">
				<div class="card-block caption-breadcrumb">
					<div class="breadcrumb-header">
						<h5>Attendance & Timesheet</h5>
					</div>
					<div class="page-header-breadcrumb">
						<ul class="breadcrumb-title">
							<li class="breadcrumb-item"><a href="#!"> <i
									class="ti-home"></i>
							</a></li>
							<li class="breadcrumb-item"><a href="#!">Employee Self
									Services</a></li>
							<li class="breadcrumb-item"><a href="#!">Time &
									Attendance</a></li>
							<li class="breadcrumb-item"><a href="#!">Attendance &
									Timesheet</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- BreadCrumb End -->
	<h5>Attendance & Timesheet</h5>
	<h8>&nbsp;</h8>
	<div class="row">
		<div class="col-sm-12">
			<div class="card">
				<div class="card-header">
					<div class="row">
						<div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 col-xs-12 mt-1">
							<button class="btn btn-info btn-block" type="button"
								data-toggle="collapse" data-target="#submittedlistExample"
								aria-expanded="false" aria-controls="collapseExample">
								Attendance</button>
						</div>
						<div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 col-xs-12 mt-1">
							<button class="btn btn-warning btn-block" type="button"
								data-toggle="collapse" data-target="#pendingExample"
								aria-expanded="false" aria-controls="collapseExample">
								Timesheet</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="row collapse show mt-2" id="submittedlistExample">
		<div class="col-sm-12 col-md-12">
			<div class="card">   
				<div class="card-header bg-info">
					<h6 class="card-title">Attendance</h6>
				</div>
				<div class="card-body">
					<div class="row">
						<div class="col-sm-12 col-md-2 col-lg-2 col-xl-2 col-xs-12 mt-1">
							<button class="btn btn-success" data-ng-click="">Login
								Time</button>
						</div>
						<div class="col-sm-12 col-md-3 col-lg-3 col-xl-3 col-xs-12 mt-1">
							<input type="text" class="form-control" data-ng-model="data.object.login_time" disabled />
						</div>
						<div class="col-sm-12 col-md-1 col-lg-1 col-xl-1 col-xs-12 mt-1">
							<label>&nbsp;</label>
						</div>
						<div class="col-sm-12 col-md-2 col-lg-2 col-xl-2 col-xs-12 mt-1">
							<button class="btn btn-success" data-ng-click="">Logout
								Time</button>
						</div>
						<div class="col-sm-12 col-md-3 col-lg-3 col-xl-3 col-xs-12 mt-1">
							<input type="text" class="form-control" data-ng-model="data.object.logout_time" disabled />
						</div>
					</div>
					<br>
					<P>Please click on submit button after clicking login or logout
					to submit your attendence.</P>
					
					<div class="row">
						<div class="col-sm-12 mt-1 text-center">
							<button class="btn btn-grd-primary hor-grd" data-ng-click="getemployeemaster(data.object);">Search</button>
						</div>
					</div>
				</div>   
			</div>
		</div>
	</div>

	<div class="row collapse mt-2" id="pendingExample">
		<div class="col-sm-12 col-md-12">
			<div class="card">
				<div class="card-header bg-warning">
					<h6 class="card-title">Timesheet</h6>
				</div>
				<div class="card-body">
					<div class="row">
						<div class="col-sm-12">
							<div class="panel panel-primary">
								<div class="panel-body">
									<div class="row">
										<div
											class="col-sm-12 col-md-2 col-lg-2 col-xl-2 col-xs-12 mt-1">
											<label class="font-weight-bold">Today Login:</label>
										</div>
										<div
											class="col-sm-12 col-md-3 col-lg-3 col-xl-3 col-xs-12 mt-1">
											<input type="time" class="form-control" data-ng-model="data.object.login_time"
												disabled />
										</div>
										<div    
											class="col-sm-12 col-md-1 col-lg-1 col-xl-1 col-xs-12 mt-1">
											<label>&nbsp;</label>
										</div>
										<div
											class="col-sm-12 col-md-2 col-lg-2 col-xl-2 col-xs-12 mt-1">
											<label class="font-weight-bold">Today Logout:</label>
										</div>
										<div
											class="col-sm-12 col-md-3 col-lg-3 col-xl-3 col-xs-12 mt-1">
											<input type="time" class="form-control" data-ng-model="data.object.logout_time"
												disabled />
										</div>
									</div>
								</div>
							</div>
							<h7>&nbsp;</h7>
							<h5>Timesheet</h5>
							<h7>&nbsp;</h7>
							<div class="row">
								<div class="col-sm-12">
									<div class="panel panel-primary">
										<div class="panel-body">
											<div class="row">
												<div    
													class="col-sm-12 col-md-3 col-lg-3 col-xl-3 col-xs-12 mt-1">
													<label class="font-weight-bold">Time Sheet
														Date&nbsp;&nbsp;<span class="text-danger">*</span>
													</label>
													<input type="date" class="form-control" id="timesheetDate" data-ng-model="data.object.timesheet_date" />
												</div>
												<div
													class="col-sm-12 col-md-3 col-lg-3 col-xl-3 col-xs-12 mt-1">
													<label class="font-weight-bold">Location&nbsp;&nbsp;<span
														class="text-danger">*</span></label> <input type="text"
														class="form-control" id="pincodeId" data-ng-model="data.object.location" />
												</div>
												<div
													class="col-sm-12 col-md-3 col-lg-3 col-xl-3 col-xs-12 mt-1">
													<label class="font-weight-bold">Duration</label> <input
														type="time" id="duration"  class="form-control" data-ng-model="data.object.duration" disabled />
												</div>
											</div>          
										</div>    
									</div>
								</div>              
							</div>     
							<h7>&nbsp;</h7>
							<div class="row">
								<div class="col-sm-12">
									<div class="panel panel-primary">
										<div class="panel-body">
											<div class="dt-responsive table-responsive">
												<table class="table table-striped table-bordered nowrap">
													<thead>
														<tr>
															<th style="min-width: 100px; max-width: 100px;">Task</th>
															<th style="min-width: 150px; max-width: 150px;">Description</th>
															<th style="min-width: 150px; max-width: 150px;">Start
																time</th>
															<th style="min-width: 150px; max-width: 150px;">End
																Time</th>
															<th style="min-width: 150px; max-width: 150px;">Duration</th>
														</tr>
													</thead>
													<tbody>
														<tr>
															<td><input class="form-control" type="text"
																placeholder="Enter Task" id="task"
																data-ng-model="data.object.task" /></td>
															<td><textarea class="form-control" type="text"
																	placeholder="Enter Description"
																	data-ng-model="data.object.description"></textarea></td>
															<td><input class="form-control" type="time"
																id="starttime" name="starttime"
																data-ng-model="data.object.start_time" /></td>
															<td><input class="form-control" type="time"
																id="endtime" name="endtime"
																data-ng-model="data.object.end_time" /></td>
															<td><input class="form-control" type="text"
																id="duration1" disabled placeholder="" /></td>
														</tr>
													</tbody>
												</table>   
											</div>     
											<div class="text-center">
												<button class="btn btn-success" data-ng-click="Insertdata(data.object);">Submit</button>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>      


      

<script>
jQuery(document).ready(
		function() {
			angular.bootstrap(jQuery("#TimeandattendanceDiv"),[ 'attendanceandTimesheet' ]);
		});
</script>
<script>
	var start = document.getElementById("starttime").value;
	var end = document.getElementById("endtime").value;
	
	document.getElementById("starttime").onchange = function() {diff(start,end)};
	document.getElementById("endtime").onchange = function() {diff(start,end)};
	
	
	function diff(start, end) {
	    start = document.getElementById("starttime").value; //to update time value in each input bar
	    end = document.getElementById("endtime").value; //to update time value in each input bar
	    
	    start = start.split(":");
	    end = end.split(":");
	    var startDate = new Date(0, 0, 0, start[0], start[1], 0);
	    var endDate = new Date(0, 0, 0, end[0], end[1], 0);
	    var diff = endDate.getTime() - startDate.getTime();
	    var hours = Math.floor(diff / 1000 / 60 / 60);
	    diff -= hours * 1000 * 60 * 60;
	    var minutes = Math.floor(diff / 1000 / 60);
	
	    return (hours < 9 ? "0" : "") + hours + ":" + (minutes < 9 ? "0" : "") + minutes;
	}
	
	setInterval(function(){document.getElementById("duration").value = diff(start, end);}, 1000); //to update time every second (1000 is 1 sec interval and function encasing original code you had down here is because setInterval only reads functions) You can change how fast the time updates by lowering the time interval
	setInterval(function(){document.getElementById("duration1").value = diff(start, end);}, 1000);
</script>
